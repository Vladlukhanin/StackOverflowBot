{"version":3,"sources":["../src/app.js"],"names":["qbChat","stackoverflowAPI","version","App","constructor","console","log","task","start","error","schedule","filter","key","pagesize","tagged","sort","order","questions","err","results","items","has_more"],"mappings":";;AACA;;;;AAEA;;;;AACA;;;;;;AAEA;;AAJA;AAKA,MAAMA,SAAS,sBAAf,C,CAPA;;AAQA,MAAMC,mBAAmB,4BAAkB,EAACC,SAAS,GAAV,EAAlB,CAAzB;;AAEA,MAAMC,GAAN,CAAU;AACNC,kBAAc;AACV,YAAI;AACAC,oBAAQC,GAAR,CAAYN,MAAZ;AACA,iBAAKO,IAAL,CAAUC,KAAV;AACH,SAHD,CAGE,OAAMC,KAAN,EAAa;AACXJ,oBAAQC,GAAR,CAAa,2BAA0BG,KAAM,EAA7C;AACH;AACJ;;AAEDF,WAAO;AACH,2BAAKG,QAAL,CAAc,aAAd,EAA6B,MAAM;AAC/B,iBAAKF,KAAL;AACH,SAFD,EAEI,IAFJ;AAGH;;AAEDA,YAAQ;AACJ,cAAMG,SAAS;AACXC,iBAAK,0BADM;AAEXC,sBAAU,CAFC;AAGXC,oBAAQ,WAHG;AAIXC,kBAAM,UAJK;AAKXC,mBAAO;AALI,SAAf;;AAQAf,yBAAiBgB,SAAjB,CAA2BA,SAA3B,CAAqCN,MAArC,EAA6C,UAASO,GAAT,EAAcC,OAAd,EAAuB;AAChE,gBAAID,GAAJ,EAAS,MAAMA,GAAN;;AAETb,oBAAQC,GAAR,CAAYa,QAAQC,KAApB;AACAf,oBAAQC,GAAR,CAAYa,QAAQE,QAApB;AACH,SALD;AAMH;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApGM;;AAuGV,IAAIlB,GAAJ","file":"app.js","sourcesContent":["// import FeedparserService from './feedparser_service';\r\nimport QBChat from './QB_modules/QBChat';\r\n// import CONFIG from '../config';\r\nimport cron from 'node-cron';\r\nimport stackexchange from 'stackexchange';\r\n\r\n// const stackoverflowFeedUrl = \"http://stackoverflow.com/feeds/tag/\";\r\nconst qbChat = new QBChat();\r\nconst stackoverflowAPI = new stackexchange({version: 2.2});\r\n\r\nclass App {\r\n    constructor() {\r\n        try {\r\n            console.log(qbChat);\r\n            this.task.start();\r\n        } catch(error) {\r\n            console.log(`cron pattern not valid: ${error}`);\r\n        }\r\n    }\r\n\r\n    task() {\r\n        cron.schedule('*/1 * * * *', () => {\r\n            this.start();\r\n        },  true);\r\n    }\r\n\r\n    start() {\r\n        const filter = {\r\n            key: 'heKdt7ZTr9pm1kqirZ6OPg((',\r\n            pagesize: 1,\r\n            tagged: 'quickblox',\r\n            sort: 'activity',\r\n            order: 'asc'\r\n        };\r\n\r\n        stackoverflowAPI.questions.questions(filter, function(err, results) {\r\n            if (err) throw err;\r\n\r\n            console.log(results.items);\r\n            console.log(results.has_more);\r\n        });\r\n    }\r\n\r\n    // start(tag, params) {\r\n    //     let self = this;\r\n    //     console.log('start by cron');\r\n    //     console.log(CONFIG.stackoverflow.additionalTags);\r\n    //\r\n    //     let feedParser = new FeedparserService();\r\n    //\r\n    //     feedParser.parse(stackoverflowFeedUrl + (tag || CONFIG.stackoverflow.mainTag), (items) => {\r\n    //             console.log(`got ${items.length} entries`);\r\n    //\r\n    //             items.forEach((item, i, arr) => {\r\n    //                 if (self.isNewEntry(item) && self.isNeededTags(item)) {\r\n    //                     console.log(`New Entry found. Date: ${item.date}. Title: ${item.title}`);\r\n    //\r\n    //                     // notify QuickBlox\r\n    //                     if (qbChat) {\r\n    //                         let message = qbChat.buildMessage(item);\r\n    //\r\n    //                         if (params) {\r\n    //                             QBChat.sendMessage({\r\n    //                                 to: params.to,\r\n    //                                 type: params.type,\r\n    //                                 text: message,\r\n    //                                 dialogId: params.dialogId\r\n    //                             });\r\n    //                         } else {\r\n    //                             qbChat.fire(message,\r\n    //                                 () => {\r\n    //                                     console.log('Message has pushed to QuickBlox successfully.');\r\n    //                                 }, (error) => {\r\n    //                                     console.error(error);\r\n    //                                 }\r\n    //                             );\r\n    //                         }\r\n    //                     }\r\n    //\r\n    //                 }\r\n    //             });\r\n    //\r\n    //         }, function(error) {\r\n    //             console.error(error);\r\n    //         }\r\n    //     );\r\n    // }\r\n    //\r\n    // isNewEntry(entry) {\r\n    //     let entryTimestamp = entry.date.getTime(),\r\n    //         currentTimestamp = Date.now();\r\n    //\r\n    //     return (currentTimestamp - entryTimestamp) <= (60 * 24 * 360 * 1000);\r\n    // }\r\n    //\r\n    // isNeededTags(entry) {\r\n    //     for (let i = 0; i < entry.categories.length; i++){\r\n    //         let entryTag = entry.categories[i];\r\n    //\r\n    //         for(let j = 0; j < CONFIG.stackoverflow.additionalTags.length; j++){\r\n    //             let tagToCheck = CONFIG.stackoverflow.additionalTags[j];\r\n    //\r\n    //             if (entryTag === tagToCheck) {\r\n    //                 return true;\r\n    //             }\r\n    //         }\r\n    //\r\n    //     }\r\n    //\r\n    //     return false;\r\n    // }\r\n}\r\n\r\nnew App();\r\n"]}